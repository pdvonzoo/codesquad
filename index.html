<!DOCTYPE>
<html>
    <head>
        <title>코드스쿼드 테스트</title>
        <link rel="stylesheet" href="./style.css">
    </head>
    <body>
        <div class="wrapper">
            <h1>숫자야구</h1>
            <input type="text" class="question" id="question" onkeyup="this.value=this.value.replace(/[^0-9]/g,'');" />
            <button onclick="conform()" class="button" id="submit">결과 확인</button>
            <div class="feedback" id="feedback"><strong>설명: 1부터 9까지 서로 다른 수로 이루어진 3자리의 수를 맞추는 게임입니다. <br>세자리 숫자를 입력해주세요.</strong></div>
        </div>
    </body>
    <script>
        let answer=[];
        let question=[];
        
        function setNumberCheck(){
            while(answer[0] == answer[1] || answer[0] == answer[2] || answer[1] == answer[2] || answer[0] == 0 || answer[1] == 0 || answer[2] == 0){
                answer[0] = Math.floor(Math.random() * 10);
                answer[1] = Math.floor(Math.random() * 10);
                answer[2] = Math.floor(Math.random() * 10);
            }   
        }
        
        function setNumber(){
            answer[0] = Math.floor(Math.random() * 10);
            answer[1] = Math.floor(Math.random() * 10);
            answer[2] = Math.floor(Math.random() * 10);
            
            setNumberCheck()
        }
        
        
        function checkResult(strikeNumber, ballNumber) {
            if(answer.length === question.length){
                if(strikeNumber == 3 ) {
                    document.getElementById("feedback").innerText = "3개의 숫자를 모두 맞히셨습니다! 게임 종료 (새로운 숫자로 리셋되었습니다.)";
                    setNumber();
                } else {
                    document.getElementById("feedback").innerText = strikeNumber + " 스크라이크 " + ballNumber + " 볼";
                }
                strikeNumber = 0;
                ballNumber = 0;
            } else {
                document.getElementById("feedback").innerText = "세자리 숫자를 입력해주세요.";
            }
        }
        
        function error(strikeNumber, ballNumber){
            if(question[0] == question[1] || question[0] == question[2] || question[1] == question[2]){
                document.getElementById("feedback").innerText = "중복되지 않은 세자리 숫자를 입력해주세요.";
                return;
            }
            if(question[0] == 0 || question[1] == 0 || question[2] == 0){
                document.getElementById("feedback").innerText = "각 자리의 숫자는 1~9까지로 입력해주세요.";
                return;
            }
            checkResult(strikeNumber, ballNumber);
        }
        
        
        function conform(){
            let strikeNumber=0 
            let ballNumber=0;
            question = document.getElementById("question").value.split("");
            for(let i = 0; i < 3; i++) {
                if(answer[i] == question[i]){
                    strikeNumber++;
                } else if(answer[i] == question[0] || answer[i] == question[1] || answer[i] == question[2]){
                    ballNumber++;
                }
            }
            error(strikeNumber, ballNumber);
        }
        
        
        function inNumber(){
            if(event.keyCode<48 || event.keyCode>57){
               event.returnValue=false;
            }
        }
        
        setNumber();
        
    </script>
</html>